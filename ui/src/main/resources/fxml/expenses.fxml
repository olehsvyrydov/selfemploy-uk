<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.Cursor?>
<?import javafx.geometry.Insets?>

<ScrollPane xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="uk.selfemploy.ui.controller.ExpenseController"
            styleClass="page-scroll"
            fitToWidth="true" hbarPolicy="NEVER">

    <VBox fx:id="expenseContainer" styleClass="page-container" spacing="24">
        <padding><Insets top="30" right="30" bottom="30" left="30"/></padding>

        <!-- Page Header -->
        <HBox alignment="CENTER_LEFT" spacing="15">
            <Label text="Expenses" styleClass="page-title"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button fx:id="addExpenseBtn" text="+ Add Expense"
                    styleClass="button-warning" onAction="#handleAddExpense"/>
        </HBox>

        <!-- Summary Cards - Bento Grid Layout -->
        <HBox styleClass="summary-cards-container" spacing="16">
            <!-- Total Expenses Card -->
            <VBox styleClass="summary-card, summary-card-total" HBox.hgrow="ALWAYS" spacing="8">
                <Label text="TOTAL EXPENSES" styleClass="metric-label"/>
                <Label fx:id="totalValue" text="£0.00" styleClass="summary-card-value, summary-card-value-total"/>
                <Label fx:id="totalCount" text="0 entries" styleClass="label-secondary"/>
            </VBox>

            <!-- Deductible Card -->
            <VBox styleClass="summary-card, summary-card-deductible" HBox.hgrow="ALWAYS" spacing="8">
                <HBox alignment="CENTER_LEFT" spacing="6">
                    <Label text="DEDUCTIBLE" styleClass="metric-label"/>
                    <Label fx:id="deductibleHelpIcon" text="i" styleClass="info-icon-circle"
                           onMouseClicked="#handleDeductibleHelp">
                        <cursor><Cursor fx:constant="HAND"/></cursor>
                        <tooltip><Tooltip text="Click to learn more about deductible expenses"/></tooltip>
                    </Label>
                </HBox>
                <Label fx:id="deductibleValue" text="£0.00" styleClass="summary-card-value, summary-card-value-deductible"/>
                <Label fx:id="deductibleCount" text="0 entries" styleClass="label-secondary"/>
            </VBox>

            <!-- Non-Deductible Card -->
            <VBox styleClass="summary-card, summary-card-nondeductible" HBox.hgrow="ALWAYS" spacing="8">
                <HBox alignment="CENTER_LEFT" spacing="6">
                    <Label text="NON-DEDUCTIBLE" styleClass="metric-label"/>
                    <Label fx:id="nonDeductibleHelpIcon" text="i" styleClass="info-icon-circle"
                           onMouseClicked="#handleNonDeductibleHelp">
                        <cursor><Cursor fx:constant="HAND"/></cursor>
                        <tooltip><Tooltip text="Click to learn more about non-deductible expenses"/></tooltip>
                    </Label>
                </HBox>
                <Label fx:id="nonDeductibleValue" text="£0.00" styleClass="summary-card-value, summary-card-value-nondeductible"/>
                <Label fx:id="nonDeductibleCount" text="0 entries" styleClass="label-secondary"/>
            </VBox>
        </HBox>

        <!-- Filters Bar -->
        <HBox styleClass="filters-bar" alignment="CENTER_LEFT" spacing="16">
            <ComboBox fx:id="categoryFilter" promptText="All Categories" prefWidth="260"/>
            <Region HBox.hgrow="ALWAYS"/>
            <TextField fx:id="searchField" promptText="Search by description..."
                       prefWidth="280" styleClass="search-field"/>
        </HBox>

        <!-- Expense Table -->
        <TableView fx:id="expenseTable" styleClass="data-table" VBox.vgrow="ALWAYS" minHeight="300">
            <columnResizePolicy>
                <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
            </columnResizePolicy>
            <columns>
                <TableColumn fx:id="dateColumn" text="DATE" prefWidth="100" minWidth="100"/>
                <TableColumn fx:id="descriptionColumn" text="DESCRIPTION" prefWidth="220"/>
                <TableColumn fx:id="categoryColumn" text="CATEGORY" prefWidth="160" minWidth="140"/>
                <TableColumn fx:id="amountColumn" text="AMOUNT" prefWidth="100" minWidth="100"/>
                <TableColumn fx:id="receiptColumn" text="RCPT" prefWidth="60" minWidth="60"/>
                <TableColumn fx:id="deductibleColumn" text="TAX" prefWidth="50" minWidth="50"/>
            </columns>
            <placeholder>
                <Label text="No expense entries found" styleClass="empty-table-message"/>
            </placeholder>
        </TableView>

        <!-- Pagination -->
        <HBox fx:id="paginationBar" styleClass="pagination-bar" alignment="CENTER" spacing="20">
            <Label fx:id="resultCount" text="Showing 0 entries" styleClass="label-secondary"/>
            <Region HBox.hgrow="ALWAYS"/>
            <Button fx:id="prevBtn" text="&lt; Previous" styleClass="button-secondary"
                    onAction="#handlePrevPage" disable="true"/>
            <Button fx:id="nextBtn" text="Next &gt;" styleClass="button-secondary"
                    onAction="#handleNextPage" disable="true"/>
        </HBox>

        <!-- Empty State -->
        <VBox fx:id="emptyState" styleClass="empty-state-container"
              alignment="CENTER" spacing="16" managed="false" visible="false">
            <padding><Insets topRightBottomLeft="60"/></padding>
            <Label text="No Expenses Recorded" styleClass="empty-state-title"/>
            <Label text="Start tracking your business costs by adding your first expense entry."
                   styleClass="empty-state-message" wrapText="true" textAlignment="CENTER" maxWidth="400"/>
        </VBox>

    </VBox>
</ScrollPane>
