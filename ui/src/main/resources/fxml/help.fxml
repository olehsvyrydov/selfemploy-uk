<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.geometry.Insets?>
<?import org.kordamp.ikonli.javafx.FontIcon?>

<!--
    Help Page - SE-701: In-App Help System
    Design: /aura (Senior UI/UX Design Architect)
    Redesign: /finn - Minimal style to match Settings page

    Features:
    - Clean, minimal design matching Settings page
    - Simple section titles (no gradient headers)
    - settings-card-row style for help topics
    - Inline Quick Links at top
-->
<ScrollPane xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="uk.selfemploy.ui.controller.HelpController"
            styleClass="help-scroll" fitToWidth="true" hbarPolicy="NEVER">

    <VBox styleClass="help-container" spacing="24">
        <padding><Insets top="30" right="30" bottom="30" left="30"/></padding>

        <!-- Page Header -->
        <VBox spacing="8">
            <Label text="Help &amp; Support" styleClass="page-title"/>
            <Label text="Find answers to common questions about UK self-employment taxes" styleClass="page-subtitle"/>
        </VBox>

        <!-- User Guide - Prominent section at top -->
        <VBox styleClass="help-section, help-section-guide" spacing="16">
            <HBox alignment="CENTER_LEFT" spacing="16">
                <Label text="User Guide" styleClass="section-title"/>
                <Button styleClass="user-guide-btn" onAction="#handleUserGuideClick" text="Open Full User Guide"/>
            </HBox>

            <!-- Getting Started -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleGettingStartedClick">
                <Label text="GS" styleClass="help-topic-badge, badge-violet"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Getting Started" styleClass="help-topic-title"/>
                    <Label text="Quick overview of app features and first steps" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- HMRC Connection -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleHmrcConnectionClick">
                <Label text="HC" styleClass="help-topic-badge, badge-violet"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="HMRC Connection" styleClass="help-topic-title"/>
                    <Label text="How OAuth2 works and password safety" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- Security & Privacy -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleSecurityPrivacyClick">
                <Label text="SP" styleClass="help-topic-badge, badge-violet"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Security &amp; Privacy" styleClass="help-topic-title"/>
                    <Label text="Local storage, encryption and data handling" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- FAQ -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleFaqClick">
                <Label text="?" styleClass="help-topic-badge, badge-violet"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="FAQ" styleClass="help-topic-title"/>
                    <Label text="Common questions and answers" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>
        </VBox>

        <!-- Quick Links - Inline buttons at top -->
        <VBox styleClass="help-section" spacing="16">
            <Label text="Quick Links to HMRC" styleClass="section-title"/>
            <FlowPane hgap="12" vgap="12" styleClass="quick-links-flow">
                <Button styleClass="help-quick-link" onAction="#handleTaxRatesLink" text="Tax Rates ↗"/>
                <Button styleClass="help-quick-link" onAction="#handleSa103Link" text="SA103 Form ↗"/>
                <Button styleClass="help-quick-link" onAction="#handleFilingDeadlinesLink" text="Deadlines ↗"/>
                <Button styleClass="help-quick-link" onAction="#handleAllowableExpensesLink" text="Expenses ↗"/>
                <Button styleClass="help-quick-link" onAction="#handleNiRatesLink" text="NI Rates ↗"/>
                <Button styleClass="help-quick-link" onAction="#handleStatePensionLink" text="State Pension ↗"/>
            </FlowPane>
        </VBox>

        <!-- Tax & Calculation Section -->
        <VBox styleClass="help-section, help-section-tax" spacing="16">
            <Label text="Tax &amp; Calculation" styleClass="section-title"/>

            <!-- Net Profit -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleNetProfitClick">
                <Label text="NP" styleClass="help-topic-badge, badge-teal"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Net Profit (Box 31)" styleClass="help-topic-title"/>
                    <Label text="Understanding your taxable profit calculation" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- Income Tax -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleIncomeTaxClick">
                <Label text="IT" styleClass="help-topic-badge, badge-teal"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Income Tax" styleClass="help-topic-title"/>
                    <Label text="Tax bands and rates for the current tax year" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- Personal Allowance -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handlePersonalAllowanceClick">
                <Label text="PA" styleClass="help-topic-badge, badge-teal"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Personal Allowance" styleClass="help-topic-title"/>
                    <Label text="Tax-free income allowance explained" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- National Insurance -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleNationalInsuranceClick">
                <Label text="NI" styleClass="help-topic-badge, badge-teal"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="National Insurance" styleClass="help-topic-title"/>
                    <Label text="National Insurance for self-employed profits" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- Payments on Account -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handlePaymentsOnAccountClick">
                <Label text="PoA" styleClass="help-topic-badge, badge-teal"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Payments on Account" styleClass="help-topic-title"/>
                    <Label text="Advance tax payments to HMRC" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>
        </VBox>

        <!-- Expenses Section -->
        <VBox styleClass="help-section, help-section-expenses" spacing="16">
            <Label text="Expenses" styleClass="section-title"/>

            <!-- Expense Categories -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleExpenseCategoriesClick">
                <Label text="EC" styleClass="help-topic-badge, badge-amber"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Expense Categories" styleClass="help-topic-title"/>
                    <Label text="SA103 expense categories explained" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- Allowable Expenses -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleAllowableExpensesClick">
                <Label text="AE" styleClass="help-topic-badge, badge-amber"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Allowable Expenses" styleClass="help-topic-title"/>
                    <Label text="What expenses can you claim?" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>
        </VBox>

        <!-- HMRC Submission Section -->
        <VBox styleClass="help-section, help-section-hmrc" spacing="16">
            <Label text="HMRC Submission" styleClass="section-title"/>

            <!-- Declaration -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleDeclarationClick">
                <Label text="D" styleClass="help-topic-badge, badge-sky"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Declaration" styleClass="help-topic-title"/>
                    <Label text="Legal declaration requirements" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- Submitting to HMRC -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleHmrcSubmissionClick">
                <Label text="S" styleClass="help-topic-badge, badge-sky"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Submitting to HMRC" styleClass="help-topic-title"/>
                    <Label text="Submitting your Self Assessment" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>
        </VBox>

        <!-- General Section -->
        <VBox styleClass="help-section, help-section-general" spacing="16">
            <Label text="General" styleClass="section-title"/>

            <!-- Tax Year -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleTaxYearClick">
                <Label text="TY" styleClass="help-topic-badge, badge-slate"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="Tax Year" styleClass="help-topic-title"/>
                    <Label text="UK tax year dates and deadlines" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>

            <!-- SA103 Form -->
            <HBox styleClass="help-topic-row" alignment="CENTER_LEFT" spacing="12" onMouseClicked="#handleSa103FormClick">
                <Label text="103" styleClass="help-topic-badge, badge-slate"/>
                <VBox spacing="4" HBox.hgrow="ALWAYS">
                    <Label text="SA103 Form" styleClass="help-topic-title"/>
                    <Label text="Self-employment supplementary pages" styleClass="help-topic-desc"/>
                </VBox>
                <Label text="›" styleClass="help-topic-chevron"/>
            </HBox>
        </VBox>

        <!-- Need More Help Section -->
        <VBox styleClass="help-section, help-section-support" spacing="16">
            <Label text="Need More Help?" styleClass="section-title"/>

            <VBox styleClass="help-support-card" spacing="12">
                <padding><Insets top="16" right="20" bottom="16" left="20"/></padding>
                <Label text="This application is open-source. For bugs or feature requests:" styleClass="help-support-text" wrapText="true"/>
                <HBox spacing="12">
                    <Button styleClass="help-quick-link" onAction="#handleGitHubIssuesLink" text="GitHub Issues ↗"/>
                    <Button styleClass="help-quick-link" onAction="#handleDocumentationLink" text="Documentation ↗"/>
                </HBox>
            </VBox>
        </VBox>

        <!-- Disclaimer -->
        <VBox styleClass="help-disclaimer" spacing="8">
            <HBox alignment="CENTER_LEFT" spacing="8">
                <FontIcon iconLiteral="fas-exclamation-triangle" iconSize="16" styleClass="disclaimer-icon"/>
                <Label text="Important Disclaimer" styleClass="disclaimer-title"/>
            </HBox>
            <Label text="This application provides tax estimates only. The information provided in the help system is for guidance purposes and may not reflect the latest HMRC rules. Always verify calculations with a qualified accountant and refer to official HMRC guidance before submitting your tax return."
                   styleClass="disclaimer-text" wrapText="true"/>
        </VBox>

    </VBox>
</ScrollPane>
